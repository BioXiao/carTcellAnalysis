filter(!is.na(nz_cov)) %>%
plot_coverage(car_dat, fits_only = TRUE, split = FALSE) +
facet_grid(car_expr_quant ~ nz_cov)
car_expr_dat_quant %>%
group_by(car_expr_quant, nz_cov) %>%
summarise(n_distinct(lib_id))
quant_indicator_dat <- salmon_quant_dat %>%
select(lib_id, Name, TPM) %>%
spread(Name, TPM) %>%
dplyr::rename(CAR = `CAR-1`) %>%
relabel_transcripts(xcript_dat) %>%
mutate_each(funs(log2(. + 1)), -lib_id) %>%
rowwise() %>%
mutate(car_expr_quant = ifelse(
max(CAR, EGFRt_r1, EGFRt_r2, EGFRt_r3, EGFRt_r4, EGFRt_r5) >= 2.5
| min(CAR, EGFRt_r1, EGFRt_r2, EGFRt_r3, EGFRt_r4, EGFRt_r5) > 4.5,
"car_expr_quant", "no_car_quant"))
car_expr_dat_quant <- p89_c1_cov_dat %>%
left_join(quant_indicator_dat %>%
select(lib_id, car_expr_quant)) %>%
group_by(lib_id) %>%
mutate(nz_cov = max(cov) >= 2) %>%
ungroup()
car_expr_dat_quant %>%
filter(!is.na(nz_cov)) %>%
plot_coverage(car_dat, fits_only = TRUE, split = FALSE) +
facet_grid(car_expr_quant ~ nz_cov)
car_expr_dat_quant %>%
group_by(car_expr_quant, nz_cov) %>%
summarise(n_distinct(lib_id))
quant_indicator_dat <- salmon_quant_dat %>%
select(lib_id, Name, TPM) %>%
spread(Name, TPM) %>%
dplyr::rename(CAR = `CAR-1`) %>%
relabel_transcripts(xcript_dat) %>%
mutate_each(funs(log2(. + 1)), -lib_id) %>%
rowwise() %>%
mutate(car_expr_quant = ifelse(
max(CAR, EGFRt_r1, EGFRt_r2, EGFRt_r3, EGFRt_r4, EGFRt_r5) >= 3.5
| min(CAR, EGFRt_r1, EGFRt_r2, EGFRt_r3, EGFRt_r4, EGFRt_r5) > 4.5,
"car_expr_quant", "no_car_quant"))
car_expr_dat_quant <- p89_c1_cov_dat %>%
left_join(quant_indicator_dat %>%
select(lib_id, car_expr_quant)) %>%
group_by(lib_id) %>%
mutate(nz_cov = max(cov) >= 2) %>%
ungroup()
car_expr_dat_quant %>%
filter(!is.na(nz_cov)) %>%
plot_coverage(car_dat, fits_only = TRUE, split = FALSE) +
facet_grid(car_expr_quant ~ nz_cov)
car_expr_dat_quant %>%
group_by(car_expr_quant, nz_cov) %>%
summarise(n_distinct(lib_id))
quant_indicator_dat <- salmon_quant_dat %>%
select(lib_id, Name, TPM) %>%
spread(Name, TPM) %>%
dplyr::rename(CAR = `CAR-1`) %>%
relabel_transcripts(xcript_dat) %>%
mutate_each(funs(log2(. + 1)), -lib_id) %>%
rowwise() %>%
mutate(car_expr_quant = ifelse(
max(CAR, EGFRt_r1, EGFRt_r2, EGFRt_r3, EGFRt_r4, EGFRt_r5) >= 4.5
| min(CAR, EGFRt_r1, EGFRt_r2, EGFRt_r3, EGFRt_r4, EGFRt_r5) > 4.5,
"car_expr_quant", "no_car_quant"))
car_expr_dat_quant <- p89_c1_cov_dat %>%
left_join(quant_indicator_dat %>%
select(lib_id, car_expr_quant)) %>%
group_by(lib_id) %>%
mutate(nz_cov = max(cov) >= 2) %>%
ungroup()
car_expr_dat_quant %>%
filter(!is.na(nz_cov)) %>%
plot_coverage(car_dat, fits_only = TRUE, split = FALSE) +
facet_grid(car_expr_quant ~ nz_cov)
car_expr_dat_quant %>%
group_by(car_expr_quant, nz_cov) %>%
summarise(n_distinct(lib_id))
quant_indicator_dat <- salmon_quant_dat %>%
select(lib_id, Name, TPM) %>%
spread(Name, TPM) %>%
dplyr::rename(CAR = `CAR-1`) %>%
relabel_transcripts(xcript_dat) %>%
mutate_each(funs(log2(. + 1)), -lib_id) %>%
rowwise() %>%
mutate(car_expr_quant = ifelse(
max(CAR, EGFRt_r1, EGFRt_r2, EGFRt_r3, EGFRt_r4, EGFRt_r5) >= 4.5
| min(CAR, EGFRt_r1, EGFRt_r2, EGFRt_r3, EGFRt_r4, EGFRt_r5) > 2.5,
"car_expr_quant", "no_car_quant"))
car_expr_dat_quant <- p89_c1_cov_dat %>%
left_join(quant_indicator_dat %>%
select(lib_id, car_expr_quant)) %>%
group_by(lib_id) %>%
mutate(nz_cov = max(cov) >= 2) %>%
ungroup()
car_expr_dat_quant %>%
filter(!is.na(nz_cov)) %>%
plot_coverage(car_dat, fits_only = TRUE, split = FALSE) +
facet_grid(car_expr_quant ~ nz_cov)
car_expr_dat_quant %>%
group_by(car_expr_quant, nz_cov) %>%
summarise(n_distinct(lib_id))
quant_indicator_dat <- salmon_quant_dat %>%
select(lib_id, Name, TPM) %>%
spread(Name, TPM) %>%
dplyr::rename(CAR = `CAR-1`) %>%
relabel_transcripts(xcript_dat) %>%
mutate_each(funs(log2(. + 1)), -lib_id) %>%
rowwise() %>%
mutate(car_expr_quant = ifelse(
max(CAR, EGFRt_r1, EGFRt_r2, EGFRt_r3, EGFRt_r4, EGFRt_r5) >= 4.5
| min(CAR, EGFRt_r1, EGFRt_r2, EGFRt_r3, EGFRt_r4, EGFRt_r5) > 1,
"car_expr_quant", "no_car_quant"))
car_expr_dat_quant <- p89_c1_cov_dat %>%
left_join(quant_indicator_dat %>%
select(lib_id, car_expr_quant)) %>%
group_by(lib_id) %>%
mutate(nz_cov = max(cov) >= 2) %>%
ungroup()
car_expr_dat_quant %>%
filter(!is.na(nz_cov)) %>%
plot_coverage(car_dat, fits_only = TRUE, split = FALSE) +
facet_grid(car_expr_quant ~ nz_cov)
car_expr_dat_quant %>%
group_by(car_expr_quant, nz_cov) %>%
summarise(n_distinct(lib_id))
quant_indicator_dat <- salmon_quant_dat %>%
select(lib_id, Name, TPM) %>%
spread(Name, TPM) %>%
dplyr::rename(CAR = `CAR-1`) %>%
relabel_transcripts(xcript_dat) %>%
mutate_each(funs(log2(. + 1)), -lib_id) %>%
rowwise() %>%
mutate(car_expr_quant = ifelse(
max(CAR, EGFRt_r1, EGFRt_r2, EGFRt_r3, EGFRt_r4, EGFRt_r5) >= 2.5
| min(CAR, EGFRt_r1, EGFRt_r2, EGFRt_r3, EGFRt_r4, EGFRt_r5) > 1,
"car_expr_quant", "no_car_quant"))
car_expr_dat_quant <- p89_c1_cov_dat %>%
left_join(quant_indicator_dat %>%
select(lib_id, car_expr_quant)) %>%
group_by(lib_id) %>%
mutate(nz_cov = max(cov) >= 2) %>%
ungroup()
car_expr_dat_quant %>%
filter(!is.na(nz_cov)) %>%
plot_coverage(car_dat, fits_only = TRUE, split = FALSE) +
facet_grid(car_expr_quant ~ nz_cov)
car_expr_dat_quant %>%
group_by(car_expr_quant, nz_cov) %>%
summarise(n_distinct(lib_id))
quant_indicator_dat <- salmon_quant_dat %>%
select(lib_id, Name, TPM) %>%
spread(Name, TPM) %>%
dplyr::rename(CAR = `CAR-1`) %>%
relabel_transcripts(xcript_dat) %>%
mutate_each(funs(log2(. + 1)), -lib_id) %>%
rowwise() %>%
mutate(car_expr_quant = ifelse(
max(CAR, EGFRt_r1, EGFRt_r2, EGFRt_r3, EGFRt_r4, EGFRt_r5) >= 2.5
| min(CAR, EGFRt_r1, EGFRt_r2, EGFRt_r3, EGFRt_r4, EGFRt_r5) > 0,
"car_expr_quant", "no_car_quant"))
car_expr_dat_quant <- p89_c1_cov_dat %>%
left_join(quant_indicator_dat %>%
select(lib_id, car_expr_quant)) %>%
group_by(lib_id) %>%
mutate(nz_cov = max(cov) >= 2) %>%
ungroup()
car_expr_dat_quant %>%
filter(!is.na(nz_cov)) %>%
plot_coverage(car_dat, fits_only = TRUE, split = FALSE) +
facet_grid(car_expr_quant ~ nz_cov)
car_expr_dat_quant %>%
group_by(car_expr_quant, nz_cov) %>%
summarise(n_distinct(lib_id))
quant_indicator_dat <- salmon_quant_dat %>%
select(lib_id, Name, TPM) %>%
spread(Name, TPM) %>%
dplyr::rename(CAR = `CAR-1`) %>%
relabel_transcripts(xcript_dat) %>%
mutate_each(funs(log2(. + 1)), -lib_id) %>%
rowwise() %>%
mutate(car_expr_quant = ifelse(
max(CAR, EGFRt_r1, EGFRt_r2, EGFRt_r3, EGFRt_r4, EGFRt_r5) >= 2.5
| min(CAR, EGFRt_r1, EGFRt_r2, EGFRt_r3, EGFRt_r4, EGFRt_r5) > 100,
"car_expr_quant", "no_car_quant"))
car_expr_dat_quant <- p89_c1_cov_dat %>%
left_join(quant_indicator_dat %>%
select(lib_id, car_expr_quant)) %>%
group_by(lib_id) %>%
mutate(nz_cov = max(cov) >= 2) %>%
ungroup()
car_expr_dat_quant %>%
filter(!is.na(nz_cov)) %>%
plot_coverage(car_dat, fits_only = TRUE, split = FALSE) +
facet_grid(car_expr_quant ~ nz_cov)
car_expr_dat_quant %>%
group_by(car_expr_quant, nz_cov) %>%
summarise(n_distinct(lib_id))
quant_indicator_dat <- salmon_quant_dat %>%
select(lib_id, Name, TPM) %>%
spread(Name, TPM) %>%
dplyr::rename(CAR = `CAR-1`) %>%
relabel_transcripts(xcript_dat) %>%
mutate_each(funs(log2(. + 1)), -lib_id) %>%
rowwise() %>%
mutate(car_expr_quant = ifelse(
max(CAR, EGFRt_r1, EGFRt_r2, EGFRt_r3, EGFRt_r4, EGFRt_r5) >= 2.5
& min(CAR, EGFRt_r1, EGFRt_r2, EGFRt_r3, EGFRt_r4, EGFRt_r5) > 1,
"car_expr_quant", "no_car_quant"))
car_expr_dat_quant <- p89_c1_cov_dat %>%
left_join(quant_indicator_dat %>%
select(lib_id, car_expr_quant)) %>%
group_by(lib_id) %>%
mutate(nz_cov = max(cov) >= 2) %>%
ungroup()
car_expr_dat_quant %>%
filter(!is.na(nz_cov)) %>%
plot_coverage(car_dat, fits_only = TRUE, split = FALSE) +
facet_grid(car_expr_quant ~ nz_cov)
car_expr_dat_quant %>%
group_by(car_expr_quant, nz_cov) %>%
summarise(n_distinct(lib_id))
quant_indicator_dat <- salmon_quant_dat %>%
select(lib_id, Name, TPM) %>%
spread(Name, TPM) %>%
dplyr::rename(CAR = `CAR-1`) %>%
relabel_transcripts(xcript_dat) %>%
mutate_each(funs(log2(. + 1)), -lib_id) %>%
rowwise() %>%
mutate(car_expr_quant = ifelse(
max(CAR, EGFRt_r1, EGFRt_r2, EGFRt_r3, EGFRt_r4, EGFRt_r5) >= 2.5
& min(CAR, EGFRt_r1, EGFRt_r2, EGFRt_r3, EGFRt_r4, EGFRt_r5) > 0,
"car_expr_quant", "no_car_quant"))
car_expr_dat_quant <- p89_c1_cov_dat %>%
left_join(quant_indicator_dat %>%
select(lib_id, car_expr_quant)) %>%
group_by(lib_id) %>%
mutate(nz_cov = max(cov) >= 2) %>%
ungroup()
car_expr_dat_quant %>%
filter(!is.na(nz_cov)) %>%
plot_coverage(car_dat, fits_only = TRUE, split = FALSE) +
facet_grid(car_expr_quant ~ nz_cov)
car_expr_dat_quant %>%
group_by(car_expr_quant, nz_cov) %>%
summarise(n_distinct(lib_id))
quant_indicator_dat <- salmon_quant_dat %>%
select(lib_id, Name, TPM) %>%
spread(Name, TPM) %>%
dplyr::rename(CAR = `CAR-1`) %>%
relabel_transcripts(xcript_dat) %>%
mutate_each(funs(log2(. + 1)), -lib_id) %>%
rowwise() %>%
mutate(car_expr_quant = ifelse(
max(CAR, EGFRt_r1, EGFRt_r2, EGFRt_r3, EGFRt_r4, EGFRt_r5) >= 2.5
& mean(CAR, EGFRt_r1, EGFRt_r2, EGFRt_r3, EGFRt_r4, EGFRt_r5) > 0,
"car_expr_quant", "no_car_quant"))
car_expr_dat_quant <- p89_c1_cov_dat %>%
left_join(quant_indicator_dat %>%
select(lib_id, car_expr_quant)) %>%
group_by(lib_id) %>%
mutate(nz_cov = max(cov) >= 2) %>%
ungroup()
car_expr_dat_quant %>%
filter(!is.na(nz_cov)) %>%
plot_coverage(car_dat, fits_only = TRUE, split = FALSE) +
facet_grid(car_expr_quant ~ nz_cov)
car_expr_dat_quant %>%
group_by(car_expr_quant, nz_cov) %>%
summarise(n_distinct(lib_id))
quant_indicator_dat <- salmon_quant_dat %>%
select(lib_id, Name, TPM) %>%
spread(Name, TPM) %>%
dplyr::rename(CAR = `CAR-1`) %>%
relabel_transcripts(xcript_dat) %>%
mutate_each(funs(log2(. + 1)), -lib_id) %>%
rowwise() %>%
mutate(car_expr_quant = ifelse(
max(CAR, EGFRt_r1, EGFRt_r2, EGFRt_r3, EGFRt_r4, EGFRt_r5) >= 2.5,
"car_expr_quant", "no_car_quant"))
car_expr_dat_quant <- p89_c1_cov_dat %>%
left_join(quant_indicator_dat %>%
select(lib_id, car_expr_quant)) %>%
group_by(lib_id) %>%
mutate(nz_cov = max(cov) >= 2) %>%
ungroup()
car_expr_dat_quant %>%
filter(!is.na(nz_cov)) %>%
plot_coverage(car_dat, fits_only = TRUE, split = FALSE) +
facet_grid(car_expr_quant ~ nz_cov)
car_expr_dat_quant %>%
group_by(car_expr_quant, nz_cov) %>%
summarise(n_distinct(lib_id))
quant_indicator_dat <- salmon_quant_dat %>%
select(lib_id, Name, TPM) %>%
spread(Name, TPM) %>%
dplyr::rename(CAR = `CAR-1`) %>%
relabel_transcripts(xcript_dat) %>%
mutate_each(funs(log2(. + 1)), -lib_id) %>%
rowwise() %>%
mutate(car_expr_quant = ifelse(
max(CAR, EGFRt_r1, EGFRt_r2, EGFRt_r3, EGFRt_r4, EGFRt_r5) >= 2.5
& mean(CAR, EGFRt_r1, EGFRt_r2, EGFRt_r3, EGFRt_r4, EGFRt_r5) > 0,
"car_expr_quant", "no_car_quant"))
car_expr_dat_quant <- p89_c1_cov_dat %>%
left_join(quant_indicator_dat %>%
select(lib_id, car_expr_quant)) %>%
group_by(lib_id) %>%
mutate(nz_cov = max(cov) >= 2) %>%
ungroup()
car_expr_dat_quant %>%
filter(!is.na(nz_cov)) %>%
plot_coverage(car_dat, fits_only = TRUE, split = FALSE) +
facet_grid(car_expr_quant ~ nz_cov)
car_expr_dat_quant %>%
group_by(car_expr_quant, nz_cov) %>%
summarise(n_distinct(lib_id))
quant_indicator_dat <- salmon_quant_dat %>%
select(lib_id, Name, TPM) %>%
spread(Name, TPM) %>%
dplyr::rename(CAR = `CAR-1`) %>%
relabel_transcripts(xcript_dat) %>%
mutate_each(funs(log2(. + 1)), -lib_id) %>%
rowwise() %>%
mutate(car_expr_quant = ifelse(
max(CAR, EGFRt_r1, EGFRt_r2, EGFRt_r3, EGFRt_r4, EGFRt_r5) >= 2
& mean(CAR, EGFRt_r1, EGFRt_r2, EGFRt_r3, EGFRt_r4, EGFRt_r5) > 0,
"car_expr_quant", "no_car_quant"))
car_expr_dat_quant <- p89_c1_cov_dat %>%
left_join(quant_indicator_dat %>%
select(lib_id, car_expr_quant)) %>%
group_by(lib_id) %>%
mutate(nz_cov = max(cov) >= 2) %>%
ungroup()
car_expr_dat_quant %>%
filter(!is.na(nz_cov)) %>%
plot_coverage(car_dat, fits_only = TRUE, split = FALSE) +
facet_grid(car_expr_quant ~ nz_cov)
car_expr_dat_quant %>%
group_by(car_expr_quant, nz_cov) %>%
summarise(n_distinct(lib_id))
quant_indicator_dat <- salmon_quant_dat %>%
select(lib_id, Name, TPM) %>%
spread(Name, TPM) %>%
dplyr::rename(CAR = `CAR-1`) %>%
relabel_transcripts(xcript_dat) %>%
mutate_each(funs(log2(. + 1)), -lib_id) %>%
rowwise() %>%
mutate(car_expr_quant = ifelse(
max(CAR, EGFRt_r1, EGFRt_r2, EGFRt_r3, EGFRt_r4, EGFRt_r5) >= 1
& mean(CAR, EGFRt_r1, EGFRt_r2, EGFRt_r3, EGFRt_r4, EGFRt_r5) > 0,
"car_expr_quant", "no_car_quant"))
car_expr_dat_quant <- p89_c1_cov_dat %>%
left_join(quant_indicator_dat %>%
select(lib_id, car_expr_quant)) %>%
group_by(lib_id) %>%
mutate(nz_cov = max(cov) >= 2) %>%
ungroup()
car_expr_dat_quant %>%
filter(!is.na(nz_cov)) %>%
plot_coverage(car_dat, fits_only = TRUE, split = FALSE) +
facet_grid(car_expr_quant ~ nz_cov)
car_expr_dat_quant %>%
group_by(car_expr_quant, nz_cov) %>%
summarise(n_distinct(lib_id))
quant_indicator_dat <- salmon_quant_dat %>%
select(lib_id, Name, TPM) %>%
spread(Name, TPM) %>%
dplyr::rename(CAR = `CAR-1`) %>%
relabel_transcripts(xcript_dat) %>%
mutate_each(funs(log2(. + 1)), -lib_id) %>%
rowwise() %>%
mutate(car_expr_quant = ifelse(
max(CAR, EGFRt_r1, EGFRt_r2, EGFRt_r3, EGFRt_r4, EGFRt_r5) >= 1
| mean(CAR, EGFRt_r1, EGFRt_r2, EGFRt_r3, EGFRt_r4, EGFRt_r5) > 0,
"car_expr_quant", "no_car_quant"))
car_expr_dat_quant <- p89_c1_cov_dat %>%
left_join(quant_indicator_dat %>%
select(lib_id, car_expr_quant)) %>%
group_by(lib_id) %>%
mutate(nz_cov = max(cov) >= 2) %>%
ungroup()
car_expr_dat_quant %>%
filter(!is.na(nz_cov)) %>%
plot_coverage(car_dat, fits_only = TRUE, split = FALSE) +
facet_grid(car_expr_quant ~ nz_cov)
car_expr_dat_quant %>%
group_by(car_expr_quant, nz_cov) %>%
summarise(n_distinct(lib_id))
quant_indicator_dat <- salmon_quant_dat %>%
select(lib_id, Name, TPM) %>%
spread(Name, TPM) %>%
dplyr::rename(CAR = `CAR-1`) %>%
relabel_transcripts(xcript_dat) %>%
mutate_each(funs(log2(. + 1)), -lib_id) %>%
rowwise() %>%
mutate(car_expr_quant = ifelse(
max(CAR, EGFRt_r1, EGFRt_r2, EGFRt_r3, EGFRt_r4, EGFRt_r5) >= 1
| mean(CAR, EGFRt_r1, EGFRt_r2, EGFRt_r3, EGFRt_r4, EGFRt_r5) > 1,
"car_expr_quant", "no_car_quant"))
car_expr_dat_quant <- p89_c1_cov_dat %>%
left_join(quant_indicator_dat %>%
select(lib_id, car_expr_quant)) %>%
group_by(lib_id) %>%
mutate(nz_cov = max(cov) >= 2) %>%
ungroup()
car_expr_dat_quant %>%
filter(!is.na(nz_cov)) %>%
plot_coverage(car_dat, fits_only = TRUE, split = FALSE) +
facet_grid(car_expr_quant ~ nz_cov)
car_expr_dat_quant %>%
group_by(car_expr_quant, nz_cov) %>%
summarise(n_distinct(lib_id))
quant_indicator_dat <- salmon_quant_dat %>%
select(lib_id, Name, TPM) %>%
spread(Name, TPM) %>%
dplyr::rename(CAR = `CAR-1`) %>%
relabel_transcripts(xcript_dat) %>%
mutate_each(funs(log2(. + 1)), -lib_id) %>%
rowwise() %>%
mutate(car_expr_quant = ifelse(
max(CAR, EGFRt_r1, EGFRt_r2, EGFRt_r3, EGFRt_r4, EGFRt_r5) >= 2.5
| min(CAR, EGFRt_r1, EGFRt_r2, EGFRt_r3, EGFRt_r4, EGFRt_r5) > 1,
"car_expr_quant", "no_car_quant"))
car_expr_dat_quant <- p89_c1_cov_dat %>%
left_join(quant_indicator_dat %>%
select(lib_id, car_expr_quant)) %>%
group_by(lib_id) %>%
mutate(nz_cov = max(cov) >= 2) %>%
ungroup()
car_expr_dat_quant %>%
filter(!is.na(nz_cov)) %>%
plot_coverage(car_dat, fits_only = TRUE, split = FALSE) +
facet_grid(car_expr_quant ~ nz_cov)
car_expr_dat_quant %>%
group_by(car_expr_quant, nz_cov) %>%
summarise(n_distinct(lib_id))
car_expr_dat_cov %>%
filter(!is.na(nz_cov),
car_expr_qaunt == "car_expr_quant") %>%
plot_coverage(car_dat, fits_only = TRUE, split = TRUE)
car_expr_dat_cov %>%
filter(!is.na(nz_cov),
car_expr_quant == "car_expr_quant") %>%
plot_coverage(car_dat, fits_only = TRUE, split = TRUE)
names(car_expr_dat_cov)
car_expr_dat_cov %>%
filter(!is.na(nz_cov),
car_expr_cov == "car_expr_cov") %>%
plot_coverage(car_dat, fits_only = TRUE, split = TRUE)
car_expr_dat_cov %>%
filter(!is.na(nz_cov),
car_expr_cov == "car_expr_cov")
mutate(has_jxn = ifelse(tra_pos | trb_pos,
"tra_or_trb", "no_jxn")) %>%
plot_coverage(car_dat, fits_only = TRUE, split = FALSE) +
facet_wrap(~ has_jxn)
car_expr_dat_cov %>%
filter(!is.na(nz_cov),
car_expr_cov == "car_expr_cov") %>%
mutate(has_jxn = ifelse(tra_pos | trb_pos,
"tra_or_trb", "no_jxn")) %>%
plot_coverage(car_dat, fits_only = TRUE, split = FALSE) +
facet_wrap(~ has_jxn)
car_expr_dat_cov %>%
filter(!is.na(nz_cov)) %>%
mutate(has_jxn = ifelse(tra_pos | trb_pos,
"tra_or_trb", "no_jxn")) %>%
plot_coverage(car_dat, fits_only = TRUE, split = FALSE) +
facet_wrap(car_expr_cov ~ has_jxn)
car_expr_dat_cov %>%
filter(!is.na(nz_cov)) %>%
mutate(has_jxn = ifelse(tra_pos | trb_pos,
"tra_or_trb", "no_jxn")) %>%
plot_coverage(car_dat, fits_only = TRUE, split = FALSE) +
facet_grid(car_expr_cov ~ has_jxn)
car_expr_dat_cov %>%
filter(!is.na(nz_cov)) %>%
mutate(has_tcr = ifelse(tcr_pos,
"tra_and_trb", "no_tcr")) %>%
plot_coverage(car_dat, fits_only = TRUE, split = FALSE) +
facet_grid(car_expr_cov ~ has_tcr)
car_expr_dat_cov %>%
filter(!is.na(nz_cov),
car_expr_cov == "car_expr_cov") %>%
plot_coverage(car_dat, fits_only = TRUE, split = TRUE)
source('~/.active-rstudio-document', echo=TRUE)
p89_c1_cov_dat %>%
mutate(pass_qual = ifelse(median_cv_coverage < 1 &
mapped_reads_w_dups > 0.7,
"pass_qc", "fail_qc")) %>%
plot_coverage(car_dat, fits_only = TRUE, split = FALSE) +
facet_wrap(~ pass_qual)
xcript_dat
xcript_dat %>% filter(seqnames != "CAR-1") %>% select(xcript_name = gene_id, segment_version = transcript_id)
p89_c1_cov_dat %>%
plot_coverage(car_dat, fits_only = TRUE)
library(knitr)
plot_coverage(bulk_cov_dat, car_dat)
car_expr_dat_cov %>%
filter(!is.na(nz_cov),
car_expr_cov == "car_expr_cov") %>%
plot_coverage(car_dat, fits_only = FALSE, split = TRUE)
source('~/.active-rstudio-document', echo=TRUE)
library(Biostrings)
reverseComplement("CTTATACACATCTCCGAGCCCACGAGACTAGGCATG")
?reverseComplement
DNAString(CTTATACACATCTCCGAGCCCACGAGACTAGGCATG)
DNAString("CTTATACACATCTCCGAGCCCACGAGACTAGGCATG")
reverseComplement(DNAString("CTTATACACATCTCCGAGCCCACGAGACTAGGCATG"))
complement("CTTATACACATCTCCGAGCCCACGAGACTAGGCATG")
complement(DNAString("CTTATACACATCTCCGAGCCCACGAGACTAGGCATG"))
